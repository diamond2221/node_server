<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<!--<meta name='apple-mobile-web-app-capable' content='yes' />
		<meta name='full-screen' content='true' />
		<meta name='x5-fullscreen' content='true' />
		<meta name='360-fullscreen' content='true' />-->
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<script type="text/javascript">
			(function (doc, win) {
			    var docEl = doc.documentElement,
			        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
			        recalc = function () {
			            window.clientWidth = docEl.clientWidth;
			            if (!window.clientWidth) return;
			            docEl.style.fontSize = 100 * (window.clientWidth / 750) + 'px';
			            window.base = 100 * (window.clientWidth / 750);
			        };
			    // Abort if browser does not support addEventListener
			    if (!doc.addEventListener) return;
			    win.addEventListener(resizeEvt, recalc, false);
			    doc.addEventListener('DOMContentLoaded', recalc, false);
			})(document, window);
		</script>
		<link rel="stylesheet" type="text/css" href="http://static.wyc.cn/activity/css/reset.css?t=1555056668843"/>
		<link rel="stylesheet" type="text/css" href="http://static.wyc.cn/activity/css/details.css?t=1555056668843"/>
		<style type="text/css">
			.notification {
			    position: fixed;
			    left: 50%;
			    top: 45%;
			    transform: translate(-50%, -50%);
			    background-color: rgba(0, 0, 0, 0.85);
			    font-size: 0.3rem;
			    color: #fff;
			    border-radius: 0.2rem;
			    padding: 0.3rem 0.42rem;
			    display: none;
			    white-space: nowrap;
			}
		</style>
	</head>
	<body>
	<div style="width: 7.5rem;overflow: hidden;position: fixed;top: 1.04rem;height: 0.5rem;z-index: 10;">
		<div class="phone">
			<img src="http://static.wyc.cn/activity/img/lbb.png" class="lb"/>
			<div class="phonegun">
				<p>用户135XXXX7897已领取</p>
			</div>
		</div>
	</div>
		<div class="wrap">
			<div class="content">
				<div class="contain">
					<p class="p1">产品包含服务项：</p>
					<p class="p2"></p>
					<!--<p class="p3">2) 免费39项检测</p>-->
					<div class="jiance">
                       
					</div>
					<p class="p5">产品有效期:</p>
					<p class="p6"></p>
					<p class="p7">使用规则：</p>
					<div class="guize">
						
					</div>
				</div>
				
				<div class="introduce">
					<p class="p1">商家介绍：</p>
					<div class="jieshao">
					
					</div>
					<p class="p1_1">预约电话：</p>
					<p class="p1_1con"></p>
					<p class="p1_2">公司地址：</p>
					<p class="p1_2con"></p>
				</div>
				
				<div class="friendship">
					<p class="p1">友情提示：</p>
					<div class="tishi">
						
					</div>
				</div>
				<div class="guishu">
					<p></p>
					<p>骆驼车服联合举办</p>
				</div>
				
			<p class="btn">点击立即领取</p>
			</div>
		</div>
		<div class="notification" id="notification">
            
        </div>
	</body>
	<script src="http://static.wyc.cn/activity/js/jquery-3.0.0.min.js?t=1555056668843" type="text/javascript" charset="utf-8"></script>
	<script src="https://static.wyc.cn/www/js/baidutongji.js?v=20180314" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		$(function(){
			var index = {
				init:function(){
					this.productId='';//商品id
					this.phonegun();
					this.dataCon();
//					var idarr = window.location.href.split('/')
//					this.channel = idarr[idarr.length-1];
					this.channel = window.location.search.split('&')[1];
					var name = window.location.search.split('&')[2].split('=')[0];
					$('.guishu>p:nth-child(1)').html('活动最终解释权归'+decodeURI(name)+'所有')
					$(window).scroll(function(){
				        // scroll at bottom
				        if ($(window).scrollTop() + $(window).height() > $(document).height()) {
				            // load data
				            $('.btn').css({'position':'absolute'})
				        }else{
				        	$('.btn').css({'position':'fixed'})
				        }
				    });
				},
				dataCon:function(){
					var that = this;
					$.ajax({
						url:window.location.href,
						type:'post',
						async:true,
						dataType:"json",
						success:function(data){
							console.log(data)
							if(data.code==200){
								if(data.data.code==400){
									that.mess(data.data.datamessage)
								}else{
									that.productId = data.data.data.id;
									$('title').html(data.data.data.name);
									$('.p2').html(data.data.data.name)
									$('.jiance').html(data.data.data.contentDetail)
									$('.p6').html(data.data.data.beginTerm+'--'+data.data.data.endTerm+' 18:00:00');
									$('.guize').html(data.data.data.useExplain);
									$('.jieshao').html(data.data.data.merchant.introduction);
									$('.p1_1con').html(data.data.data.merchant.contactPhone);
									$('.p1_2con').html(data.data.data.merchant.address);
									$('.tishi').html(data.data.data.prompt);
									var timestamp = new Date().getTime();
									if(timestamp>data.data.data.endDate){
										$('.btn').css({
											'background':'#BFB7AF',
										})
									}else{
										$('.btn').css({
											'background':'linear-gradient(90deg,rgba(255,149,63,1) 0%,rgba(255,201,71,1) 100%)',
	'box-shadow':'0 0.02rem 0.2rem 0 rgba(213,5,0,1)'
										})
										that.btn();
									}
								}
							}else{
								that.mess(data.msg+data.data)
							}
						}
					})
				},
				//提交
				btn:function(){
					var that = this;
					$('.btn').on('click',function(){
						window.location.href='/luotuo/submit?channel&'+that.channel+'&productId&'+that.productId
					})
				},
				//异常提示
				mess:function(html,func){
					var timer = '';
					function notification(message, cb) {
				        $("#notification").html(message).fadeIn(500, function() {
			                timer = setTimeout(
			                    function() {
			                        $(this).fadeOut(500, function(params) {
			                            cb && cb();
			                            clearTimeout(timer);
			                        });
			                    }.bind(this),
			                    2400
			                );
			            });
				    }
					notification(html, func)
				},
				//电话滚动
				phonegun:function(){
				var that = this;
					setInterval(function(){
						$('.phone').removeClass('move')
						setTimeout(function(){
							$('.phone').addClass('move')
							$('.phonegun>p').html('用户'+that.getMoble()+'已领取')
						},100)
					},5000)
					var style = document.createElement('style');
					document.head.appendChild(style);
//					var width = window.innerWidth;
//					var from = `from { visibility: visible; -webkit-transform: translateX(${width}px); }`;
//					var to = `to { visibility: visible; -webkit-transform: translateX(-100%); }`;
//					style.sheet.insertRule(`@-webkit-keyframes barrage { ${from} ${to} }`, 0);
					var width = window.innerWidth;
					var from = 'from { visibility: visible; -webkit-transform: translateX('+width+'px);}';
					var to = 'to { visibility: visible; -webkit-transform: translateX(-100%); }';
					style.sheet.insertRule('@-webkit-keyframes barrage { '+from+to+' }'), 
					$('.phone').addClass('move')
				},
				//随机手机号
				getMoble:function() {
					var prefixArray = new Array("130", "131", "132", "133", "135", "137", "138", "170", "187", "189");
					var i = parseInt(10 * Math.random());
					var prefix = prefixArray[i];//前三位
					var prefix2 = ''
					for (var j = 0; j < 4; j++) {
						prefix2 += Math.floor(Math.random() * 10);
					}
					return prefix+'XXXX'+prefix2
				}
				
			}
			index.init()
		})
	</script>
</html>
